<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>H5 éŠæˆ²äº‹ä»¶è¿½è¸ªå ±å‘Š - ç°¡åŒ–ç·¨è¼¯ç‰ˆ</title>
    <style>
        /* å°ˆæ¥­å ±å‘Šæ¨£å¼ - èˆ‡åŸæª”æ¡ˆä¿æŒä¸€è‡´ */
        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6; 
            color: #333; 
            margin: 0; 
            padding: 0; 
            background: #ffffff; 
            color: #333333;
        }
        
        .container {
            padding: 20px;
            max-width: 1400px;
            margin: 0 auto;
        }
        
        /* æ¨™é¡Œå€åŸŸ */
        .header {
            background: #ffffff;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            border: 1px solid #e0e0e0;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .header h1 {
            color: #333333;
            margin: 0 0 10px 0;
            font-size: 24px;
            font-weight: 600;
        }
        
        .game-url {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 6px;
            margin: 15px 0;
            border: 1px solid #e9ecef;
        }
        
        .url-label {
            color: #6c757d;
            font-size: 14px;
            margin-bottom: 8px;
            font-weight: 500;
        }
        
        .url-value {
            color: #333333;
            font-family: 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, 'Courier New', monospace;
            font-size: 14px;
            word-break: break-all;
            background: #ffffff;
            padding: 8px;
            border-radius: 4px;
            border: 1px solid #dee2e6;
        }
        
        .copy-btn {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            margin: 15px auto;
            font-size: 14px;
            transition: all 0.3s ease;
            font-weight: 500;
            display: block;
            width: fit-content;
            box-shadow: 0 2px 4px rgba(0, 123, 255, 0.2);
        }
        
        .copy-btn:hover {
            background: #0056b3;
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(0, 123, 255, 0.3);
        }
        
        .generation-time {
            color: #6c757d;
            font-size: 14px;
            margin: 15px 0;
            font-weight: 500;
        }
        
        /* äº‹ä»¶è¡¨æ ¼ */
        .event-table {
            width: 100%;
            border-collapse: collapse;
            background: #ffffff;
            border-radius: 8px;
            overflow: hidden;
            border: 1px solid #e0e0e0;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .event-table th {
            background: #f8f9fa;
            color: #333333;
            padding: 15px;
            text-align: left;
            font-weight: 600;
            border-bottom: 1px solid #dee2e6;
            font-size: 14px;
        }
        
        .event-table td {
            padding: 15px;
            border-bottom: 1px solid #f1f3f4;
            vertical-align: top;
            font-size: 14px;
        }
        
        .event-table tr:hover {
            background: #f8f9fa;
        }
        
        .event-table tr:last-child td {
            border-bottom: none;
        }
        
        /* å¯ç·¨è¼¯å€åŸŸæ¨£å¼ */
        .editable {
            padding: 4px 8px;
            border: 2px dashed transparent;
            border-radius: 4px;
            transition: all 0.2s ease;
            cursor: pointer;
            min-height: 20px;
            display: inline-block;
        }
        
        .editable:hover {
            border-color: #007bff;
            background: #e3f2fd;
        }
        
        .editable:focus {
            outline: none;
            border-color: #007bff;
            background: #ffffff;
            box-shadow: 0 0 0 2px rgba(0, 123, 255, 0.2);
        }
        
        .editable.event-name {
            font-weight: 600;
            color: #333333;
            font-family: 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, 'Courier New', monospace;
        }
        
        /* äº‹ä»¶ç‹€æ…‹ */
        .event-status {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .event-status:hover {
            transform: scale(1.05);
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
        }
        
        .event-status.passed {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .event-status.failed {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        /* è¦å‰‡åˆ—è¡¨ */
        .rules-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        
        .rule-item {
            display: flex;
            align-items: flex-start;
            gap: 8px;
            margin-bottom: 8px;
            padding: 8px;
            background: #f8f9fa;
            border-radius: 4px;
            border: 1px solid #e9ecef;
            transition: all 0.2s ease;
        }
        
        .rule-item:hover {
            background: #e9ecef;
            border-color: #007bff;
        }
        
        .rule-status {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            flex-shrink: 0;
            margin-top: 4px;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .rule-status:hover {
            transform: scale(1.2);
        }
        
        .rule-status.passed {
            background: #28a745;
        }
        
        .rule-status.failed {
            background: #dc3545;
        }
        
        .rule-text {
            flex: 1;
            font-size: 13px;
            line-height: 1.4;
            color: #333333;
            padding: 4px 8px;
            border: 2px dashed transparent;
            border-radius: 4px;
            transition: all 0.2s ease;
            cursor: pointer;
        }
        
        .rule-text:hover {
            border-color: #007bff;
            background: #e3f2fd;
        }
        
        .rule-text:focus {
            outline: none;
            border-color: #007bff;
            background: #ffffff;
            box-shadow: 0 0 0 2px rgba(0, 123, 255, 0.2);
        }
        
        /* æˆªåœ–å€åŸŸ */
        .screenshot-area {
            text-align: center;
            cursor: pointer;
        }
        
        .screenshot-placeholder {
            width: 120px;
            height: 80px;
            background: #f8f9fa;
            border: 2px dashed #dee2e6;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #6c757d;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .screenshot-placeholder:hover {
            border-color: #007bff;
            background: #e3f2fd;
            color: #007bff;
            transform: scale(1.05);
        }
        
        .screenshot-image {
            max-width: 120px;
            max-height: 80px;
            border-radius: 6px;
            cursor: pointer;
            border: 1px solid #dee2e6;
            transition: all 0.2s ease;
        }
        
        .screenshot-image:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
        
        /* æ·»åŠ æ–°äº‹ä»¶æŒ‰éˆ• */
        .add-event-btn {
            background: #28a745;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            margin: 20px 0;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s ease;
            width: 100%;
        }
        
        .add-event-btn:hover {
            background: #218838;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(40, 167, 69, 0.3);
        }
        
        /* æç¤ºä¿¡æ¯ */
        .edit-hint {
            background: #e3f2fd;
            border: 1px solid #2196f3;
            border-radius: 6px;
            padding: 15px;
            margin: 20px 0;
            color: #1976d2;
            font-size: 14px;
        }
        
        .edit-hint strong {
            color: #1565c0;
        }
        
        /* ç·¨è¼¯æç¤º */
        .edit-tooltip {
            position: absolute;
            background: #333;
            color: white;
            padding: 8px 12px;
            border-radius: 4px;
            font-size: 12px;
            z-index: 1000;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.2s ease;
        }
        
        .edit-tooltip.show {
            opacity: 1;
        }
        
        /* ç‹€æ…‹æ¨™ç±¤æ¨£å¼ */
        .event-status.passed::before {
            content: "âœ… ";
        }
        
        .event-status.failed::before {
            content: "âŒ ";
        }
        
        /* éŸ¿æ‡‰å¼è¨­è¨ˆ */
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .event-table {
                font-size: 12px;
            }
            
            .event-table th,
            .event-table td {
                padding: 10px;
            }
        }
        
        /* å‹•ç•«æ•ˆæœ */
        .fade-in {
            animation: fadeIn 0.3s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* éš±è—æ–‡ä»¶è¼¸å…¥ */
        .file-input {
            display: none;
        }
        
        /* æˆåŠŸæç¤º */
        .success-message {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #28a745;
            color: white;
            padding: 12px 20px;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 500;
            z-index: 1000;
            opacity: 0;
            transform: translateX(100%);
            transition: all 0.3s ease;
        }
        
        .success-message.show {
            opacity: 1;
            transform: translateX(0);
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- ç·¨è¼¯æç¤º -->
        <div class="edit-hint">
            <strong>ğŸ’¡ ç°¡åŒ–ç·¨è¼¯æç¤ºï¼š</strong>
            é»æ“Šä»»ä½•æ–‡å­—å…§å®¹å³å¯ç›´æ¥ç·¨è¼¯ï¼Œé»æ“Šç‹€æ…‹å¯åˆ‡æ›ï¼Œé»æ“Šæˆªåœ–å€åŸŸå¯ä¸Šå‚³ã€‚æ‰€æœ‰ä¿®æ”¹æœƒè‡ªå‹•ä¿å­˜ã€‚
        </div>
        
        <!-- æ¨™é¡Œå€åŸŸ -->
        <div class="header">
            <h1 class="editable" contenteditable="true">H5 éŠæˆ²äº‹ä»¶è¿½è¸ªå ±å‘Š</h1>
            <div class="game-url">
                <div class="url-label">æ¸¸æˆURL:</div>
                <div class="url-value editable" contenteditable="true">https://h5.stg.g123.jp/game/kumo</div>
                <button class="copy-btn" onclick="shareReport()">ä¸€éµåˆ†äº«æ‰“é»å ±å‘Š</button>
            </div>
            <div class="generation-time editable" contenteditable="true">ç”Ÿæˆæ—¶é—´: 2025/8/21 10:12:20</div>
        </div>
        
        <!-- äº‹ä»¶è¿½è¸ªè¡¨æ ¼ -->
        <table class="event-table">
            <thead>
                <tr>
                    <th>äº‹ä»¶åç§°</th>
                    <th>é€šè¿‡</th>
                    <th>è§„åˆ™</th>
                    <th>æˆªå›¾</th>
                </tr>
            </thead>
            <tbody>
                <tr data-event="g_init">
                    <td>
                        <span class="editable event-name" contenteditable="true">g_init</span>
                    </td>
                    <td>
                        <span class="event-status failed" onclick="toggleEventStatus(this)">å¤±è´¥</span>
                    </td>
                    <td>
                        <ul class="rules-list">
                            <li class="rule-item">
                                <span class="rule-status failed" onclick="toggleRuleStatus(this)"></span>
                                <span class="rule-text editable" contenteditable="true">g_initéœ€è¦éŠæˆ²æœ€ä¸€é–‹å§‹ä¸Šå ±</span>
                            </li>
                            <li class="rule-item">
                                <span class="rule-status passed" onclick="toggleRuleStatus(this)"></span>
                                <span class="rule-text editable" contenteditable="true">g_init äº‹ä»¶åè·Ÿéšg_register äº‹ä»¶,é¡ºåºæ­£ç¡®</span>
                            </li>
                            <li class="rule-item">
                                <span class="rule-status passed" onclick="toggleRuleStatus(this)"></span>
                                <span class="rule-text editable" contenteditable="true">g_init äº‹ä»¶åœ¨ p_game_loaded äº‹ä»¶ä¹‹å,é¡ºåºæ­£ç¡®</span>
                            </li>
                        </ul>
                    </td>
                    <td class="screenshot-area">
                        <div class="screenshot-placeholder" onclick="uploadScreenshot('g_init')">
                            ğŸ“· æ·»åŠ æˆªå›¾
                        </div>
                        <input type="file" class="file-input" id="screenshot_g_init" accept="image/*" onchange="handleScreenshotUpload(event, 'g_init')">
                    </td>
                </tr>
                <tr data-event="g_register">
                    <td>
                        <span class="editable event-name" contenteditable="true">g_register</span>
                    </td>
                    <td>
                        <span class="event-status passed" onclick="toggleEventStatus(this)">é€šè¿‡</span>
                    </td>
                    <td>
                        <ul class="rules-list">
                            <li class="rule-item">
                                <span class="rule-status passed" onclick="toggleRuleStatus(this)"></span>
                                <span class="rule-text editable" contenteditable="true">schema æ ¡éªŒé€šè¿‡</span>
                            </li>
                            <li class="rule-item">
                                <span class="rule-status passed" onclick="toggleRuleStatus(this)"></span>
                                <span class="rule-text editable" contenteditable="true">game_server_id çš„å€¼ä¸å…¶ä»–äº‹ä»¶ä¸€è‡´</span>
                            </li>
                            <li class="rule-item">
                                <span class="rule-status passed" onclick="toggleRuleStatus(this)"></span>
                                <span class="rule-text editable" contenteditable="true">role_id çš„å€¼ä¸å…¶ä»–äº‹ä»¶ä¸€è‡´</span>
                            </li>
                            <li class="rule-item">
                                <span class="rule-status passed" onclick="toggleRuleStatus(this)"></span>
                                <span class="rule-text editable" contenteditable="true">g_register äº‹ä»¶ç”¨æˆ·ç”Ÿæ¶¯ä»…ä¸€æ¬¡</span>
                            </li>
                            <li class="rule-item">
                                <span class="rule-status passed" onclick="toggleRuleStatus(this)"></span>
                                <span class="rule-text editable" contenteditable="true">g_register äº‹ä»¶ä¸g_init äº‹ä»¶çš„æ—¶é—´é—´éš”ç¬¦åˆè¦æ±‚</span>
                            </li>
                        </ul>
                    </td>
                    <td class="screenshot-area">
                        <div class="screenshot-placeholder" onclick="uploadScreenshot('g_register')">
                            ğŸ“· æ·»åŠ æˆªå›¾
                        </div>
                        <input type="file" class="file-input" id="screenshot_g_register" accept="image/*" onchange="handleScreenshotUpload(event, 'g_register')">
                    </td>
                </tr>
                <tr data-event="g_milestone">
                    <td>
                        <span class="editable event-name" contenteditable="true">g_milestone</span>
                    </td>
                    <td>
                        <span class="event-status passed" onclick="toggleEventStatus(this)">é€šè¿‡</span>
                    </td>
                    <td>
                        <ul class="rules-list">
                            <li class="rule-item">
                                <span class="rule-status passed" onclick="toggleRuleStatus(this)"></span>
                                <span class="rule-text editable" contenteditable="true">milestone äº‹ä»¶åœ¨æ­£ç¡®æ—¶æœºè§¦å‘</span>
                            </li>
                            <li class="rule-item">
                                <span class="rule-status passed" onclick="toggleRuleStatus(this)"></span>
                                <span class="rule-text editable" contenteditable="true">milestone æ•°æ®æ ¼å¼æ­£ç¡®</span>
                            </li>
                        </ul>
                    </td>
                    <td class="screenshot-area">
                        <div class="screenshot-placeholder" onclick="uploadScreenshot('g_milestone')">
                            ğŸ“· æ·»åŠ æˆªå›¾
                        </div>
                        <input type="file" class="file-input" id="screenshot_g_milestone" accept="image/*" onchange="handleScreenshotUpload(event, 'g_milestone')">
                    </td>
                </tr>
            </tbody>
        </table>
        
        <!-- æ·»åŠ æ–°äº‹ä»¶æŒ‰éˆ• -->
        <button class="add-event-btn" onclick="addNewEvent()">+ æ·»åŠ æ–°äº‹ä»¶</button>
    </div>
    
    <!-- æˆåŠŸæç¤º -->
    <div class="success-message" id="successMessage">ä¿å­˜æˆåŠŸï¼</div>
    
    <script>
        let eventData = {
            'g_init': {
                name: 'g_init',
                status: 'failed',
                rules: [
                    { status: 'failed', text: 'g_initéœ€è¦éŠæˆ²æœ€ä¸€é–‹å§‹ä¸Šå ±' },
                    { status: 'passed', text: 'g_init äº‹ä»¶åè·Ÿéšg_register äº‹ä»¶,é¡ºåºæ­£ç¡®' },
                    { status: 'passed', text: 'g_init äº‹ä»¶åœ¨ p_game_loaded äº‹ä»¶ä¹‹å,é¡ºåºæ­£ç¡®' }
                ],
                screenshot: null
            },
            'g_register': {
                name: 'g_register',
                status: 'passed',
                rules: [
                    { status: 'passed', text: 'schema æ ¡éªŒé€šè¿‡' },
                    { status: 'passed', text: 'game_server_id çš„å€¼ä¸å…¶ä»–äº‹ä»¶ä¸€è‡´' },
                    { status: 'passed', text: 'role_id çš„å€¼ä¸å…¶ä»–äº‹ä»¶ä¸€è‡´' },
                    { status: 'passed', text: 'g_register äº‹ä»¶ç”¨æˆ·ç”Ÿæ¶¯ä»…ä¸€æ¬¡' },
                    { status: 'passed', text: 'g_register äº‹ä»¶ä¸g_init äº‹ä»¶çš„æ—¶é—´é—´éš”ç¬¦åˆè¦æ±‚' }
                ],
                screenshot: null
            },
            'g_milestone': {
                name: 'g_milestone',
                status: 'passed',
                rules: [
                    { status: 'passed', text: 'milestone äº‹ä»¶åœ¨æ­£ç¡®æ—¶æœºè§¦å‘' },
                    { status: 'passed', text: 'milestone æ•°æ®æ ¼å¼æ­£ç¡®' }
                ],
                screenshot: null
            }
        };
        
        // åˆ‡æ›äº‹ä»¶ç‹€æ…‹
        function toggleEventStatus(element) {
            const eventName = element.closest('tr').dataset.event;
            const currentStatus = element.classList.contains('passed') ? 'passed' : 'failed';
            const newStatus = currentStatus === 'passed' ? 'failed' : 'passed';
            
            // æ›´æ–°æ¨£å¼
            element.classList.remove(currentStatus);
            element.classList.add(newStatus);
            element.textContent = newStatus === 'passed' ? 'é€šè¿‡' : 'å¤±è´¥';
            
            // æ›´æ–°æ•¸æ“š
            eventData[eventName].status = newStatus;
            
            // é¡¯ç¤ºæˆåŠŸæç¤º
            showSuccessMessage('çŠ¶æ€å·²æ›´æ–°');
            
            // è‡ªå‹•ä¿å­˜
            saveData();
        }
        
        // åˆ‡æ›è¦å‰‡ç‹€æ…‹
        function toggleRuleStatus(element) {
            const currentStatus = element.classList.contains('passed') ? 'passed' : 'failed';
            const newStatus = currentStatus === 'passed' ? 'failed' : 'passed';
            
            // æ›´æ–°æ¨£å¼
            element.classList.remove(currentStatus);
            element.classList.add(newStatus);
            
            // é¡¯ç¤ºæˆåŠŸæç¤º
            showSuccessMessage('è§„åˆ™çŠ¶æ€å·²æ›´æ–°');
            
            // è‡ªå‹•ä¿å­˜
            saveData();
        }
        
        // ä¸Šå‚³æˆªåœ–
        function uploadScreenshot(eventName) {
            document.getElementById(`screenshot_${eventName}`).click();
        }
        
        // è™•ç†æˆªåœ–ä¸Šå‚³
        function handleScreenshotUpload(event, eventName) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const imageData = e.target.result;
                    eventData[eventName].screenshot = imageData;
                    
                    // æ›´æ–°é¡¯ç¤º
                    const screenshotArea = document.querySelector(`tr[data-event="${eventName}"] .screenshot-area`);
                    screenshotArea.innerHTML = `
                        <img src="${imageData}" class="screenshot-image" onclick="viewScreenshot('${imageData}')" alt="æˆªå›¾">
                        <input type="file" class="file-input" id="screenshot_${eventName}" accept="image/*" onchange="handleScreenshotUpload(event, '${eventName}')">
                    `;
                    
                    // é¡¯ç¤ºæˆåŠŸæç¤º
                    showSuccessMessage('æˆªå›¾ä¸Šä¼ æˆåŠŸ');
                    
                    // è‡ªå‹•ä¿å­˜
                    saveData();
                };
                reader.readAsDataURL(file);
            }
        }
        
        // æŸ¥çœ‹æˆªåœ–
        function viewScreenshot(imageData) {
            const newWindow = window.open();
            newWindow.document.write(`
                <html>
                    <head><title>æˆªå›¾æŸ¥çœ‹</title></head>
                    <body style="margin:0; padding:20px; background:#000; text-align:center;">
                        <img src="${imageData}" style="max-width:100%; max-height:90vh; border-radius:8px;">
                    </body>
                </html>
            `);
        }
        
        // æ·»åŠ æ–°äº‹ä»¶
        function addNewEvent() {
            const eventName = prompt('è¯·è¾“å…¥æ–°äº‹ä»¶åç§°:');
            if (eventName && eventName.trim()) {
                const newEvent = {
                    name: eventName.trim(),
                    status: 'passed',
                    rules: [
                        { status: 'passed', text: 'æ–°è§„åˆ™' }
                    ],
                    screenshot: null
                };
                
                eventData[eventName.trim()] = newEvent;
                
                // æ·»åŠ åˆ°è¡¨æ ¼
                const tbody = document.querySelector('.event-table tbody');
                const newRow = createEventRow(eventName.trim(), newEvent);
                tbody.appendChild(newRow);
                
                // é¡¯ç¤ºæˆåŠŸæç¤º
                showSuccessMessage('æ–°äº‹ä»¶å·²æ·»åŠ ');
                
                // è‡ªå‹•ä¿å­˜
                saveData();
            }
        }
        
        // å‰µå»ºäº‹ä»¶è¡Œ
        function createEventRow(eventName, event) {
            const tr = document.createElement('tr');
            tr.dataset.event = eventName;
            tr.innerHTML = `
                <td>
                    <span class="editable event-name" contenteditable="true">${event.name}</span>
                </td>
                <td>
                    <span class="event-status ${event.status}" onclick="toggleEventStatus(this)">${event.status === 'passed' ? 'é€šè¿‡' : 'å¤±è´¥'}</span>
                </td>
                <td>
                    <ul class="rules-list">
                        ${event.rules.map(rule => `
                            <li class="rule-item">
                                <span class="rule-status ${rule.status}" onclick="toggleRuleStatus(this)"></span>
                                <span class="rule-text editable" contenteditable="true">${rule.text}</span>
                            </li>
                        `).join('')}
                    </ul>
                </td>
                <td class="screenshot-area">
                    <div class="screenshot-placeholder" onclick="uploadScreenshot('${eventName}')">
                        ğŸ“· æ·»åŠ æˆªå›¾
                    </div>
                    <input type="file" class="file-input" id="screenshot_${eventName}" accept="image/*" onchange="handleScreenshotUpload(event, '${eventName}')">
                </td>
            `;
            return tr;
        }
        
        // é¡¯ç¤ºæˆåŠŸæç¤º
        function showSuccessMessage(message) {
            const successMsg = document.getElementById('successMessage');
            successMsg.textContent = message;
            successMsg.classList.add('show');
            
            setTimeout(() => {
                successMsg.classList.remove('show');
            }, 2000);
        }
        
        // è‡ªå‹•ä¿å­˜
        function saveData() {
            localStorage.setItem('eventReportData', JSON.stringify(eventData));
            console.log('æ•°æ®å·²è‡ªåŠ¨ä¿å­˜');
        }
        
        // ä¸€éµåˆ†äº«æ‰“é»å ±å‘Š
        function shareReport() {
            // ç”Ÿæˆå®Œæ•´çš„å ±å‘ŠHTML
            const reportHTML = generateFullReport();
            
            // å‰µå»ºBlobå°è±¡
            const blob = new Blob([reportHTML], { type: 'text/html' });
            
            // å‰µå»ºä¸‹è¼‰éˆæ¥
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `æ‰“é»å ±å‘Š_${new Date().toISOString().slice(0, 10)}.html`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            showSuccessMessage('æ‰“é»å ±å‘Šå·²ç”Ÿæˆä¸¦ä¸‹è¼‰ï¼');
        }
        
        // ç”Ÿæˆå®Œæ•´å ±å‘ŠHTML
        function generateFullReport() {
            const title = document.querySelector('.header h1').textContent;
            const gameUrl = document.querySelector('.url-value').textContent;
            const generationTime = document.querySelector('.generation-time').textContent;
            const table = document.querySelector('.event-table');
            
            return `<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>${title}</title>
    <style>
        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6; 
            color: #333; 
            margin: 0; 
            padding: 20px; 
            background: #ffffff; 
        }
        .container { max-width: 1400px; margin: 0 auto; }
        .header { background: #ffffff; padding: 20px; border-radius: 8px; margin-bottom: 20px; border: 1px solid #e0e0e0; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
        .header h1 { color: #333333; margin: 0 0 10px 0; font-size: 24px; font-weight: 600; }
        .game-url { background: #f8f9fa; padding: 15px; border-radius: 6px; margin: 15px 0; border: 1px solid #e9ecef; }
        .url-label { color: #6c757d; font-size: 14px; margin-bottom: 8px; font-weight: 500; }
        .url-value { color: #333333; font-family: 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, 'Courier New', monospace; font-size: 14px; word-break: break-all; background: #ffffff; padding: 8px; border-radius: 4px; border: 1px solid #dee2e6; }
        .generation-time { color: #6c757d; font-size: 14px; margin: 15px 0; font-weight: 500; }
        .event-table { width: 100%; border-collapse: collapse; background: #ffffff; border-radius: 8px; overflow: hidden; border: 1px solid #e0e0e0; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
        .event-table th { background: #f8f9fa; color: #333333; padding: 15px; text-align: left; font-weight: 600; border-bottom: 1px solid #dee2e6; font-size: 14px; }
        .event-table td { padding: 15px; border-bottom: 1px solid #f1f3f4; vertical-align: top; font-size: 14px; }
        .event-status { display: inline-flex; align-items: center; gap: 8px; padding: 6px 12px; border-radius: 20px; font-size: 12px; font-weight: 600; text-transform: uppercase; }
        .event-status.passed { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .event-status.failed { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
        .event-status.passed::before { content: "âœ… "; }
        .event-status.failed::before { content: "âŒ "; }
        .rules-list { list-style: none; padding: 0; margin: 0; }
        .rule-item { display: flex; align-items: flex-start; gap: 8px; margin-bottom: 8px; padding: 8px; background: #f8f9fa; border-radius: 4px; border: 1px solid #e9ecef; }
        .rule-status { width: 12px; height: 12px; border-radius: 50%; flex-shrink: 0; margin-top: 4px; }
        .rule-status.passed { background: #28a745; }
        .rule-status.failed { background: #dc3545; }
        .rule-text { flex: 1; font-size: 13px; line-height: 1.4; color: #333333; }
        .screenshot-image { max-width: 120px; max-height: 80px; border-radius: 6px; border: 1px solid #dee2e6; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>${title}</h1>
            <div class="game-url">
                <div class="url-label">æ¸¸æˆURL:</div>
                <div class="url-value">${gameUrl}</div>
            </div>
            <div class="generation-time">${generationTime}</div>
        </div>
        ${table.outerHTML}
    </div>
</body>
</html>`;
        }
        
        // ç‚ºæ‰€æœ‰å¯ç·¨è¼¯å…ƒç´ æ·»åŠ è‡ªå‹•ä¿å­˜
        document.addEventListener('DOMContentLoaded', function() {
            // ç›£è½æ‰€æœ‰å¯ç·¨è¼¯å…ƒç´ çš„è®ŠåŒ–
            document.addEventListener('input', function(event) {
                if (event.target.classList.contains('editable')) {
                    // å»¶é²ä¿å­˜ï¼Œé¿å…é »ç¹ä¿å­˜
                    clearTimeout(window.saveTimeout);
                    window.saveTimeout = setTimeout(() => {
                        saveData();
                        showSuccessMessage('å†…å®¹å·²ä¿å­˜');
                    }, 1000);
                }
            });
            
            // ç›£è½å…§å®¹ç·¨è¼¯å®Œæˆ
            document.addEventListener('blur', function(event) {
                if (event.target.classList.contains('editable')) {
                    saveData();
                }
            }, true);
            
            // è¼‰å…¥ä¿å­˜çš„æ•¸æ“š
            const savedData = localStorage.getItem('eventReportData');
            if (savedData) {
                try {
                    eventData = JSON.parse(savedData);
                    // æ›´æ–°é¡¯ç¤º
                    updateTableDisplay();
                } catch (e) {
                    console.log('è¼‰å…¥ä¿å­˜æ•¸æ“šå¤±æ•—ï¼Œä½¿ç”¨é»˜èªæ•¸æ“š');
                }
            }
            
            console.log('ç°¡åŒ–ç·¨è¼¯å ±å‘Šå·²åŠ è¼‰å®Œæˆï¼');
            console.log('ğŸ’¡ ä½¿ç”¨æç¤ºï¼š');
            console.log('â€¢ é»æ“Šä»»ä½•æ–‡å­—å…§å®¹å³å¯ç›´æ¥ç·¨è¼¯');
            console.log('â€¢ é»æ“Šäº‹ä»¶ç‹€æ…‹å¯åˆ‡æ›é€šè¿‡/å¤±è´¥');
            console.log('â€¢ é»æ“Šè¦å‰‡ç‹€æ…‹é»å¯åˆ‡æ›âœ…/âŒ');
            console.log('â€¢ é»æ“Šæˆªåœ–å€åŸŸå¯ç›´æ¥ä¸Šå‚³');
            console.log('â€¢ æ‰€æœ‰ä¿®æ”¹æœƒè‡ªå‹•ä¿å­˜');
        });
        
        // æ›´æ–°è¡¨æ ¼é¡¯ç¤º
        function updateTableDisplay() {
            Object.keys(eventData).forEach(eventName => {
                const row = document.querySelector(`tr[data-event="${eventName}"]`);
                if (row) {
                    // æ›´æ–°äº‹ä»¶åç¨±
                    const nameCell = row.querySelector('.event-name');
                    if (nameCell) nameCell.textContent = eventData[eventName].name;
                    
                    // æ›´æ–°ç‹€æ…‹
                    const statusCell = row.querySelector('.event-status');
                    if (statusCell) {
                        statusCell.className = `event-status ${eventData[eventName].status}`;
                        statusCell.textContent = eventData[eventName].status === 'passed' ? 'é€šè¿‡' : 'å¤±è´¥';
                    }
                    
                    // æ›´æ–°è¦å‰‡
                    const rulesCell = row.querySelector('.rules-list');
                    if (rulesCell) {
                        rulesCell.innerHTML = '';
                        eventData[eventName].rules.forEach(rule => {
                            const li = document.createElement('li');
                            li.className = 'rule-item';
                            li.innerHTML = `
                                <span class="rule-status ${rule.status}" onclick="toggleRuleStatus(this)"></span>
                                <span class="rule-text editable" contenteditable="true">${rule.text}</span>
                            `;
                            rulesCell.appendChild(li);
                        });
                    }
                    
                    // æ›´æ–°æˆªåœ–
                    const screenshotCell = row.querySelector('.screenshot-area');
                    if (screenshotCell && eventData[eventName].screenshot) {
                        screenshotCell.innerHTML = `
                            <img src="${eventData[eventName].screenshot}" class="screenshot-image" onclick="viewScreenshot('${eventData[eventName].screenshot}')" alt="æˆªå›¾">
                            <input type="file" class="file-input" id="screenshot_${eventName}" accept="image/*" onchange="handleScreenshotUpload(event, '${eventName}')">
                        `;
                    }
                }
            });
        }
    </script>
</body>
</html>
