# 支付自动填入功能说明

## 功能概述

H5 Debug Helper 新增了支付自动填入功能，为开发者和测试人员提供智能的支付表单自动填入和测试工具。

## 主要特性

### 💳 智能自动填入
- **手动模式**: 完全手动输入支付信息
- **模板模式**: 使用预定义的支付模板快速填入
- **智能模式**: 根据当前时间和场景自动选择合适的支付模板

### 📋 支付模板管理
- **测试模板**: 包含标准测试支付和高额测试支付
- **生产模板**: 真实支付环境模板（需要手动填入敏感信息）
- **自定义模板**: 支持创建和保存自定义支付模板

### 🔄 实时状态监控
- 支付处理状态实时显示
- 成功/失败状态反馈
- 交易ID自动生成和管理

## 使用方法

### 1. 访问支付功能
在H5 Debug Helper主界面，点击右侧标签页中的"💳 支付自动填入"标签。

### 2. 选择自动填入模式
- **手动**: 适合需要完全控制支付信息的场景
- **模板**: 选择预定义的支付模板快速填入
- **智能**: 系统根据当前时间自动选择合适模板

### 3. 使用支付模板
点击"选择模板"按钮，可以看到以下预定义模板：
- 测试支付 ¥1000 - 标准测试支付
- 高额测试 ¥50000 - 高额度测试支付
- 生产环境支付 - 真实支付环境模板

### 4. 快速操作
使用底部的快速操作按钮：
- 测试支付 ¥1000
- 高额测试 ¥50000
- 智能填入

## 支付表单字段

### 卡片信息
- **卡号**: 支持自动格式化显示（1234 5678 9012 3456）
- **持卡人**: 自动转换为大写
- **有效期**: MM/YY 格式
- **CVV**: 仅允许数字输入

### 支付金额
- **金额**: 数字输入
- **货币**: 支持 JPY、USD、EUR、CNY
- **商户ID**: 自定义商户标识符

### 交易信息
- **交易ID**: 自动生成的唯一标识符

## 安全特性

- 生产环境模板不包含真实的支付卡信息
- 所有敏感信息仅在本地处理
- 支持交易ID自动生成，确保唯一性
- 支付状态实时反馈，避免重复提交

## 技术实现

### 组件结构
```
PaymentAutoFill/
├── 状态管理 (useState)
├── 模板系统
├── 表单验证
├── 自动填入逻辑
└── UI交互
```

### 核心功能
- **智能模板选择**: 基于时间和场景的自动选择
- **表单格式化**: 卡号、日期等字段的自动格式化
- **状态管理**: 支付处理状态的完整生命周期管理
- **错误处理**: 完善的错误处理和用户反馈

## 开发说明

### 添加新的支付模板
在 `PaymentAutoFill.tsx` 中的 `templates` 数组中添加新模板：

```typescript
{
  id: 'custom-template',
  name: '自定义模板',
  description: '自定义支付模板',
  data: {
    cardNumber: '4111111111111111',
    cardHolder: 'CUSTOM USER',
    expiryDate: '12/25',
    cvv: '123',
    amount: '2000',
    currency: 'JPY',
    merchantId: 'CUSTOM_MERCHANT',
    transactionId: 'CUSTOM_' + Date.now()
  },
  category: 'custom',
  lastUsed: new Date()
}
```

### 自定义支付处理逻辑
在 `handlePaymentComplete` 回调函数中添加自定义处理逻辑：

```typescript
const handlePaymentComplete = (paymentData) => {
  // 自定义支付完成处理逻辑
  console.log('Payment completed:', paymentData)
  // 可以添加API调用、数据存储等逻辑
}
```

## 注意事项

1. **测试环境**: 所有预定义模板仅适用于测试环境
2. **数据安全**: 生产环境使用时请确保敏感信息安全
3. **网络请求**: 当前版本为模拟支付，实际使用时需要集成真实的支付API
4. **浏览器兼容**: 支持现代浏览器的所有功能

## 未来计划

- [ ] 支持更多支付方式（支付宝、微信支付等）
- [ ] 添加支付历史记录功能
- [ ] 支持批量支付测试
- [ ] 集成真实的支付API
- [ ] 添加支付性能分析功能
